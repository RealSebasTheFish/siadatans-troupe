<!DOCTYPE html>
<html>
    <head>
        <title>Pathwise</title>
        <link rel="stylesheet" type="text/css" href="main.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
        <script src="https://cdn.socket.io/4.8.0/socket.io.min.js" integrity="sha384-OoIbkvzsFFQAG88r+IqMAjyOtYDPGO0cqK5HF5Uosdy/zUEGySeAzytENMDynREd" crossorigin="anonymous"></script>
        <script>
            const socket = io("https://fb85-199-212-64-70.ngrok-free.app/", { transports : ['websocket'] });
            console.log(socket);

            $(document).ready(function(){
                socket.on("connect", () => {
                    console.log("Connection Successful!");
                });

                socket.on("response-packet", function(data) {
                    data["type"]
                });
            });

            function openReportMenu() {
                $("#report-select-menu").css("display", "block");
            }

            function closeReportMenu() {
                $("#report-select-menu").css("display", "none");
            }


            function openIncentiveMenu() {
                $("#incentive-select-menu").css("display", "block");
            }

            function closeIncentiveMenu() {
                $("#incentive-select-menu").css("display", "none");
            }

            function report(type) {
                var latitude = null;
                var longitude = null;
                var name = null;
                const data = {
                    "type": type, // Ping type
                    "location": {
                        "latitude": latitude, // location part 1
                        "longitude": longitude // location part 2
                    },
                    "timestamp": new Date().toISOString(), // timestamp from the server
                    "username": name, // username input
                };

                socket.emit("report-packet", data);
            }
        </script>
    </head>
    <body>
        <iframe id="map" style="border:0" loading="lazy" allowfullscreen src="https://www.google.com/maps/embed/v1/view?zoom=13&center=43.7735%2C-79.5019&key=AIzaSyC8eS78o6WnetL25F4Fg7-74WpSBKAKmSY"></iframe>
        <button id="report-button" onclick="openReportMenu();"><img id="report-button-image" src="img/caution.png" /></button>
        <button id="incentive-button" onclick="openIncentiveMenu();"><img id="incentive-button-image" src="img/dollar-sign.png" /></button>
        <div id="report-select-menu">
            <table>
                <tr>
                    <td class="report-image" onclick="report('police');"><img src="img/police.png" /></td>
                    <td class="report-image" onclick="report('crash');"><img src="img/crash.png" /></td>
                    <td class="report-image" onclick="report('pothole');"><img src="img/pothole.png" /></td>
                </tr>
                <tr>
                    <td class="report-image" onclick="report('blocked-lane');"><img src="img/blocked-lane.png" /></td>
                    <td class="report-image" onclick="report('bad-weather');"><img src="img/bad-weather.png" /></td>
                    <td class="report-image" onclick="report('construction');"><img src="img/construction.png" /></td>
                </tr>
                <tr>
                    <td class="report-image" onclick="report('car-on-shoulder');"><img src="img/car-on-shoulder.png" /></td>
                    <td class="report-image" onclick="report('gas-prices');"><img src="img/gas-prices.png" /></td>
                    <td class="report-image" onclick="closeReportMenu();"><img src="img/x.png" /></td>
                </tr>
            </table>
        </div>

        <div id="incentive-select-menu">
            <img id="close-incentive-menu" onclick="closeIncentiveMenu();" src="img/x.png" />
            <table>
                <tr><td>

                    </td>
                </tr>
            </table>
        </div>
    </body>
</html>